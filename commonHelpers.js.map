{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/loadmoreservice.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function searchPhotoQuery({ q, page, per_page }) {\n  const API_KEY = '45152929-a1340ee97784cf10d0ad70de4';\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page,\n  });\n\n  try {\n    return await axios.get('', { params });\n  } catch (err) {\n    console.error(err);\n  }\n}\n","export default class ButtonService {\n  constructor(buttonEL, hiddenClass) {\n    this.buttonEL = buttonEL;\n    this.hiddenClass = hiddenClass;\n  }\n\n  hide() {\n    this.buttonEL.classList.add(this.hiddenClass);\n  }\n\n  show() {\n    this.buttonEL.classList.remove(this.hiddenClass);\n  }\n\n  disable() {\n    this.buttonEL.disabled = true;\n  }\n\n  enable() {\n    this.buttonEL.disabled = false;\n  }\n}\n","'use strict';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { searchPhotoQuery } from './js/pixabay-api.js';\nimport { createImages, clearImages } from './js/render-function.js';\nimport { toggleLoader } from './js/loader.js';\nimport ButtonService from './js/loadmoreservice.js';\n\nconst loadMoreBtnEl = document.querySelector('.btn');\nconst loadMoreBtn = new ButtonService(loadMoreBtnEl, 'is-hidden');\nloadMoreBtn.hide();\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\n\nconst form = document.querySelector('.js-form');\nconst picturesList = document.querySelector('.list');\n// console.log(picturesList);\n\nconst loader = document.querySelector('.loader');\n\nform.addEventListener('submit', searchPhot);\n\nasync function searchPhoto(event) {\n  event.preventDefault();\n  picturesList.innerHTML = '';\n  const searchForm = event.currentTarget;\n  // params.q = form.elements.search.value.toLowerCase().trim();\n\n  params.q = event.target.request.value.trim().toLowerCase();\n\n  if (!params.q) {\n    loadMoreBtn.hide();\n    iziToast.error({\n      message: 'Please enter the data in the input field',\n      position: 'topRight',\n      messageColor: '#ffffff',\n      backgroundColor: '#EF4040',\n    });\n    return;\n  }\n\n  params.page = 1;\n\n  loadMoreBtn.show();\n  loadMoreBtn.disable();\n\n  try {\n    toggleLoader(true);\n    const { total, hits } = await searchPhotoQuery(params);\n    params.maxPage = Math.ceil(total / params.per_page);\n\n    if (params.maxPage > 1) {\n      loadMoreBtn.enable();\n      loadMoreBtnEl.addEventListener('click', handleLoadMore);\n    } else {\n      loadMoreBtn.hide();\n    }\n    if (!hits.length) {\n      loadMoreBtn.hide();\n      iziToast.error({\n        message: `Sorry, there was an error fetching the images. Please try again later!`,\n        position: 'topRight',\n        messageColor: '#ffffff',\n        backgroundColor: '#EF4040',\n      });\n      return;\n    }\n    createImages(hits);\n  } catch (err) {\n    loadMoreBtn.hide();\n    iziToast.error({\n      message: 'Sorry, there are no images matching your search',\n      position: 'topRight',\n      messageColor: '#ffffff',\n      backgroundColor: '#EF4040',\n    });\n  } finally {\n    toggleLoader(false);\n    if (params.page === params.maxPage) {\n      loadMoreBtn.hide();\n      loadMoreBtnEl.removeEventListener('click', handleLoadMore);\n    } else {\n      loadMoreBtn.enable();\n    }\n    searchForm.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  loadMoreBtn.disable();\n  params.page += 1;\n  try {\n    toggleLoader(true);\n    const { hits } = await searchPhoto(params);\n    createImages(hits);\n\n    let elem = document.querySelector('.list-item');\n    let rect = elem.getBoundingClientRect();\n\n    window.scrollBy({\n      top: rect.height * 2,\n      left: rect.width,\n      behavior: 'smooth',\n    });\n\n    // console.log(rect.height);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    toggleLoader(false);\n    if (params.page >= params.maxPage) {\n      loadMoreBtn.hide();\n      iziToast.info({\n        message: 'You have reached the end of search results.',\n        position: 'topRight',\n        messageColor: '#ffffff',\n        backgroundColor: '#4e75ff',\n      });\n\n      loadMoreBtn.hide();\n      loadMoreBtnEl.removeEventListener('click', handleLoadMore);\n    } else {\n      loadMoreBtn.enable();\n    }\n  }\n}\n"],"names":["axios","ButtonService","buttonEL","hiddenClass","loadMoreBtnEl","loadMoreBtn","form"],"mappings":"svBAIAA,EAAM,SAAS,QAAU,2BCJV,MAAMC,CAAc,CACjC,YAAYC,EAAUC,EAAa,CACjC,KAAK,SAAWD,EAChB,KAAK,YAAcC,CACpB,CAED,MAAO,CACL,KAAK,SAAS,UAAU,IAAI,KAAK,WAAW,CAC7C,CAED,MAAO,CACL,KAAK,SAAS,UAAU,OAAO,KAAK,WAAW,CAChD,CAED,SAAU,CACR,KAAK,SAAS,SAAW,EAC1B,CAED,QAAS,CACP,KAAK,SAAS,SAAW,EAC1B,CACH,CCZA,MAAMC,EAAgB,SAAS,cAAc,MAAM,EAC7CC,EAAc,IAAIJ,EAAcG,EAAe,WAAW,EAChEC,EAAY,KAAI,EAShB,MAAMC,EAAO,SAAS,cAAc,UAAU,EACzB,SAAS,cAAc,OAAO,EAGpC,SAAS,cAAc,SAAS,EAE/CA,EAAK,iBAAiB,SAAU,UAAU"}