{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/js/loader.js","../src/js/loadmoreservice.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function searchPhotoQuery({ q, page, per_page = 20 }) {\n  const API_KEY = '45176158-e3d3b26982233790558f60971';\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page,\n  });\n\n  try {\n    return await axios\n      .get('', { params })\n      .then(({ data }) => data)\n      .catch(err => console.log(err));\n  } catch (err) {\n    console.error(err);\n  }\n}\n","'use strict';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function createImages(data) {\n  const gallery = document.querySelector('.js-gallery');\n  let markUp = data\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class = \"list-item\">\n  <a href=\"${largeImageURL}\">\n    <div class = \"preview-photo\"><img src=\"${webformatURL}\" alt=\"${tags}\"></div>\n     <ul class=\"img-desc\">\n    <li>\n      <h2>Likes</h2>\n      <p>${likes}</p>\n    </li>\n    <li>\n      <h2>Views</h2>\n      <p>${views}</p>\n    </li>\n    <li>\n      <h2>Comments</h2>\n      <p>${comments}</p>\n    </li>\n    <li>\n      <h2>Downloads</h2>\n      <p>${downloads}</p>\n    </li>\n  </ul>\n  </a>\n\n</li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markUp);\n\n  const lightbox = new SimpleLightbox('.gallery  a', {\n    captions: true,\n    captionsDelay: 250,\n    captionsData: 'alt',\n  });\n  lightbox.refresh();\n}\n\nexport function clearImages() {\n  const galleryList = document.querySelector('.gallery');\n  galleryList.innerHTML = '';\n}\n\nexport function catchError() {\n  return iziToast.show({\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    color: 'red',\n    position: 'topRight',\n    closeOnClick: true,\n  });\n}\n","export function toggleLoader(isVisible) {\n  const loader = document.querySelector('.js-loader');\n  if (loader) {\n    if (isVisible) {\n      loader.style.display = 'inline-block';\n    } else {\n      loader.style.display = 'none';\n    }\n  }\n}\n","export default class ButtonService {\n  constructor(buttonEL, hiddenClass) {\n    this.buttonEL = buttonEL;\n    this.hiddenClass = hiddenClass;\n  }\n\n  hide() {\n    this.buttonEL.classList.add(this.hiddenClass);\n  }\n\n  show() {\n    this.buttonEL.classList.remove(this.hiddenClass);\n  }\n\n  disable() {\n    this.buttonEL.disabled = true;\n  }\n\n  enable() {\n    this.buttonEL.disabled = false;\n  }\n}\n","'use strict';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { searchPhotoQuery } from './js/pixabay-api.js';\nimport { createImages, clearImages } from './js/render-function.js';\nimport { toggleLoader } from './js/loader.js';\nimport ButtonService from './js/loadmoreservice.js';\n\nconst loadMoreBtnEl = document.querySelector('.btn');\nconst loadMoreBtn = new ButtonService(loadMoreBtnEl, 'is-hidden');\nloadMoreBtn.hide();\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\n\nconst form = document.querySelector('.js-form');\nform.addEventListener('submit', searchPhoto);\n\nasync function searchPhoto(event) {\n  event.preventDefault();\n  clearImages();\n\n  const searchForm = event.currentTarget;\n  params.q = searchForm.elements.request.value.toLowerCase().trim();\n\n  if (!params.q) {\n    loadMoreBtn.hide();\n    iziToast.error({\n      message: 'Please enter the data in the input field',\n      position: 'topRight',\n      messageColor: '#ffffff',\n      backgroundColor: '#EF4040',\n    });\n    toggleLoader(false);\n    return;\n  }\n\n  params.page = 1;\n\n  loadMoreBtn.show();\n  loadMoreBtn.disable();\n\n  try {\n    toggleLoader(true);\n    const { total, hits } = await searchPhotoQuery(params);\n    params.maxPage = Math.ceil(total / params.per_page);\n\n    if (params.maxPage > 1) {\n      loadMoreBtn.enable();\n      loadMoreBtnEl.addEventListener('click', handleLoadMore);\n    } else {\n      loadMoreBtn.hide();\n    }\n    if (!hits.length) {\n      loadMoreBtn.hide();\n      iziToast.error({\n        message: `Sorry, there was an error fetching the images. Please try again later!`,\n        position: 'topRight',\n        messageColor: '#ffffff',\n        backgroundColor: '#EF4040',\n      });\n      return;\n    }\n    createImages(hits);\n  } catch (err) {\n    loadMoreBtn.hide();\n    iziToast.error({\n      message: 'Sorry, there are no images matching your search',\n      position: 'topRight',\n      messageColor: '#ffffff',\n      backgroundColor: '#EF4040',\n    });\n  } finally {\n    toggleLoader(false);\n    if (params.page === params.maxPage) {\n      loadMoreBtn.hide();\n      loadMoreBtnEl.removeEventListener('click', handleLoadMore);\n    } else {\n      loadMoreBtn.enable();\n    }\n    searchForm.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  loadMoreBtn.disable();\n  params.page += 1;\n\n  try {\n    toggleLoader(true);\n    const { hits } = await searchPhotoQuery(params);\n    createImages(hits);\n\n    let elem = document.querySelector('.list-item');\n    let rect = elem.getBoundingClientRect();\n\n    window.scrollBy({\n      top: rect.height * 2,\n      left: rect.width,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.log(error);\n  } finally {\n    toggleLoader(false);\n    if (params.page >= params.maxPage) {\n      loadMoreBtn.hide();\n      iziToast.info({\n        message: 'We`re sorry, but you`ve reached the end of search results.',\n        position: 'topRight',\n        messageColor: '#ffffff',\n        backgroundColor: '#4e75ff',\n      });\n\n      loadMoreBtn.hide();\n      loadMoreBtnEl.removeEventListener('click', handleLoadMore);\n    } else {\n      loadMoreBtn.enable();\n    }\n  }\n}\n"],"names":["axios","searchPhotoQuery","q","page","per_page","API_KEY","params","data","err","createImages","gallery","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearImages","galleryList","toggleLoader","isVisible","loader","ButtonService","buttonEL","hiddenClass","loadMoreBtnEl","loadMoreBtn","form","searchPhoto","event","searchForm","iziToast","total","hits","handleLoadMore","rect","error"],"mappings":"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"}